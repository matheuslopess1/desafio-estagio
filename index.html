<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listagem de Pessoas</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css" />
</head>
<body>
    <div class="section">
        <div class="container">
            <h1 class="title">Listagem de Pessoas</h1>
            <h2 class="subtitle">Desafio para o Est√°gio na Moovery.</h2>
            <div class="mb-3">
                <button class="button is-white has-text-primary" onclick="getRandomUsers()">
                    <span class="icon is-small">
                        <i class="fas fa-sync"></i>
                    </span>
                    <span>Atualizar</span>
                </button>
            </div>
            <table class="table is-fullwidth">
                <thead>
                    <tr>
                        <th>Foto</th>
                        <th>Nome</th>
                        <th>Sobrenome</th>
                        <th>Idade</th>
                        <th>Cidade</th>
                    </tr>
                </thead>
                <tbody>
                    <tbody id="table-body">
                    </tbody>
                </tbody>
            </table>
        </div>
    </div>
    <script defer src="https://use.fontawesome.com/releases/v5.14.0/js/all.js"></script>
    <script>
        const getRandomUsers = () => fetch('https://api.randomuser.me/?results=10')
            .then(response =>
                response.json().then(body => {
                    const tableBodyElement = document.getElementById('table-body')
                    while (tableBodyElement.childElementCount > 0)
                        tableBodyElement.removeChild(tableBodyElement.lastElementChild)
                    for (const user of body.results) {
                        const tableRowElement = document.createElement('tr')
                        tableBodyElement.append(tableRowElement)
                        
                        const photoTableDataElement = document.createElement('td')
                        tableRowElement.append(photoTableDataElement)

                        const imageElement = document.createElement('img')
                        photoTableDataElement.append(imageElement)
                        imageElement.setAttribute('src', user.picture.thumbnail)
                        
                        const { name: { first, last }, dob: { age }, location: { city } } = user

                        for (const data of [first, last, age, city]) {
                            const tableDataElement = document.createElement('td')
                            tableRowElement.append(tableDataElement)
                            tableDataElement.style.verticalAlign = 'middle'
                            const dataTextNode = document.createTextNode(data)
                            tableDataElement.append(dataTextNode)
                        }
                    }
                })
            )
            .catch(console.error)

            getRandomUsers()
    </script>
</body>
</html>